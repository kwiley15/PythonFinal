<!DOCTYPE html>
<html>
<head>
    <title>Search Netflix Content</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
</head>
<body>
    <h1>Search & Filter Netflix Content</h1>

    <form method="get">
        <input type="text" name="q" placeholder="Search by title, director, cast" value="{{ query }}">
        
        <div>
            <label><strong>Genres:</strong></label><br>

            {% for g in listed_in_choices  %}
                <label class="me-3">
                    <input type="checkbox" name="listed_in" value="{{ g }}"
                        {% if g in selected_grenres %}checked{% endif %}>
                    {{ g }}
                </label>
            {% endfor %}
        </div>

        <select name="year">
            <option value="">All Years</option>
            {% for y in years %}
                <option value="{{ y }}" {% if y|stringformat:"s" == year_filter|stringformat:"s" %}selected{% endif %}>{{ y }}</option>
            {% endfor %}
        </select>

        <select name="country">
            <option value="">All Countries</option>
            {% for c in countries %}
                <option value="{{ c }}" {% if c == country_filter %}selected{% endif %}>{{ c }}</option>
            {% endfor %}
        </select>

        <button type="submit">Search</button>
    </form>

    <ul>
        {% for item in page_obj %}
            <li>{{ item.title }} ({{ item.release_year }}) - {{ item.listed_in }} - {{ item.country }}</li>
        {% empty %}
            <li>No results found.</li>
        {% endfor %}
    </ul>

    <div class="pagination">
        {% if page_obj.has_previous %}
            <a href="?page={{ page_obj.previous_page_number }}&q={{ query }}&listed_in={{ genre_filter }}&year={{ year_filter }}&country={{ country_filter }}">Previous</a>
        {% endif %}
        Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}&q={{ query }}&listed_in={{ genre_filter }}&year={{ year_filter }}&country={{ country_filter }}">Next</a>
        {% endif %}
    </div>

    <p><a href="{% url 'index' %}">Back to Home</a></p>
</body>
</html>
